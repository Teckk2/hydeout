---
layout: post
title: Bypassing CISCO ISE(NAC)
categories:
  - Exploits
---
<p>Last week I was assigned a project for a Very Big Organization to do a Internal PT, and it was a gray box pentesting, The main objective was to bypass their newly installed Cisco ISE, So I decided to share my experience with you. Let's start from scratch.</p>
<br>**What is CISCO ISE?**
<p>Cisco (ISE) – Cisco Identity Services Engine (Cisco ISE) is a next generation identity and access control policy platform that enables enterprises to enforce compliance, enhance infrastructure security, and streamline their service operation.</p>

<br>**What is NAC?**
<p>Network Access Control or NAC is a solution to prevent unauthorized access to internal networks. It restricts access to the network based on identity or security posture of the device that is trying to connect.</p>

<br>**How NAC works?**
<p>When a tool connects to the community, the NAC depends on a number of detection methods to detect the units’ presence. They are listed under:</p>

<br>**DHCP Proxy** – a NAC resolution intercepts DHCP requests for community configuration info coming from components working on the community disclosing their presence.
<br>
<br>**Broadcast Listener** – a NAC resolution listens to broadcast community visitors, corresponding to ARP requests, DHCP requests, and so forth., generated by components working on the community disclosing their presence.
<br>
<br>**Listening to (sniffing) IP visitors** – IP packets passing by way of a sure monitoring location disclosing a sure ingredient is linked to the community.
<br>
<br>**Client-Based Software** – some NAC options make use of client-based software program as a part of the answer structure, which is used to carry out endpoint security assessment to forestall a component from acquiring community configuration info till it’s evaluated and to inform a centralized administration console the ingredient is on the community.
<br>
<br>**SNMP Traps** – some switches might be configured to ship an SNMP entice when a brand new MAC deal with is registered with a sure swap port. The SNMP entice info particulars the MAC deal with and the community interface on which it was registered.

<p>Most of the NAC solutions available today use only one of the detection techniques. Detecting various devices on the network is one of the key elements of the NAC and if the NAC is incorrectly configured and if it fails at detecting a device connecting to the network, the NAC solution can be bypassed.</p>

<br>**The scenario of the attack and how I bypassed NAC**

<br>As you know it was a Gray box Pentesting I have only physical access to the target organization and had no prior knowledge of the network/infrastructure or subnet ranges nor had my device whitelisted on the network.
<br>As every penetration test starts, my first step begins with information gathering. I had nothing but a VoIP phone next to me of an employee who was on leave. I started to look at the settings, and I got the following details:
<br> * Call Manager TFTP server IP address
<br> * DHCP server IP
<br> * Default gateway
<br> * MAC Address of VoIP phone, etc
